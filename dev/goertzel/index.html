<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Goertzel&#39;s Algorithms · FourierAnalysis</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><a href="../"><img class="logo" src="../assets/logo.png" alt="FourierAnalysis logo"/></a><h1>FourierAnalysis</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../">FourierAnalysis Documentation</a></li><li><a class="toctext" href="../MainModule/">Main Module</a></li><li><a class="toctext" href="../tapers/">Tapering Window</a></li><li><span class="toctext">frequency domain</span><ul><li><a class="toctext" href="../spectra/">Spectral Estimations</a></li><li><a class="toctext" href="../crossspectra/">Cross-Spectral Matrices</a></li><li><a class="toctext" href="../coherence/">Coherence Matrices</a></li><li class="current"><a class="toctext" href>Goertzel&#39;s Algorithms</a><ul class="internal"></ul></li></ul></li><li><span class="toctext">time-frequency(TF) domain</span><ul><li><a class="toctext" href="../timefrequency/">TF Representations</a></li><li><a class="toctext" href="../timefrequencyuni/">TF Univariate Measures</a></li><li><a class="toctext" href="../timefrequencybi/">TF Bivariate Measures </a></li></ul></li><li><span class="toctext">utilities</span><ul><li><a class="toctext" href="../plots/">Plots</a></li><li><a class="toctext" href="../tools/">Tools</a></li><li><a class="toctext" href="../fftw/">FFTW planners</a></li><li><a class="toctext" href="../filters/">Filter Banks</a></li><li><a class="toctext" href="../hilbert/">Hilbert Transform</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li>frequency domain</li><li><a href>Goertzel&#39;s Algorithms</a></li></ul><a class="edit-page" href="https://github.com/Marco-Congedo/FourierAnalysis.jl/blob/master/docs/src/goertzel.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Goertzel&#39;s Algorithms</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="goertzel.jl-1" href="#goertzel.jl-1">goertzel.jl</a></h1><p>This unit implements three <strong>Goertzel&#39;s algorithms</strong> for estimating DFT complex coefficients at a specific frequency.</p><p>The result of Goertzel&#39;s algorithm for a given frequency is practically identical to the output of an FFT for that frequency, but requieres only <span>$t$</span> operations, where <span>$t$</span> is the window length in samples. Since the complexity of FFT algirthms is <span>$t*log(t)$</span>, Goertzels&#39; algorithm are advantageous when only one or a few coefficients are needed. Furthermore, the estimation of Goertzel&#39;s algorithms is not restricted to a Fourier discrete frequency, but can be in the whole positive real line up to the Nyquist frequency. Smart block on-line implementations are also possible.</p><p><strong>References</strong></p><p>Goertzel G (1958) <a href="https://pdfs.semanticscholar.org/a5e4/d0faf65627374b1ac82c3c79006d010173c9.pdf">An algorithm for the evaluation of finite trigonometric series</a>. The American Mathematical Monthly, 65(1), 34-35.</p><p>See also <a href="https://www.st.com/content/ccc/resource/technical/document/design_tip/group0/20/06/95/0b/c3/8d/4a/7b/DM00446805/files/DM00446805.pdf/jcr:content/translations/en.DM00446805.pdf">here</a>.</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="FourierAnalysis.goertzel" href="#FourierAnalysis.goertzel"><code>FourierAnalysis.goertzel</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">function goertzel( x   :: Vector{T},
                   f   :: IntOrReal,
                   sr  :: Int,
                   wl  :: Int,
               startAT :: Int = 1) where T&lt;:Union{Real, Complex}</code></pre><p>Given a time series as input vector <code>x</code> sampled at <code>sr</code> sampling rate, return the DFT complex coefficient at the discrete Fourier frequency which is the closest to <code>f</code>. The coefficient is computed for the time window starting at <code>startAt</code> (one-based) and of lenght <code>wl</code>.</p><p>If <code>startAT</code>=1 (default) the first <code>wl</code> samples of the vector are considered.</p><p><code>wl</code> does not need to be power of 2.</p><p><strong>See also</strong>: <a href="#FourierAnalysis.goertzel_fast"><code>goertzel_fast</code></a>, <a href="#FourierAnalysis.goertzel2"><code>goertzel2</code></a>.</p><p><strong>Examples</strong>:</p><pre><code class="language-none">using FourierAnalysis
sr, t, f, a = 128, 128, 5, 10
v=sinusoidal(a, f, sr, t, 0)
c=goertzel(v, f, sr, t) # should output 0+aim</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/Marco-Congedo/FourierAnalysis.jl/blob/45490ae1851aae84a1541ab078e1ac3f39d4a133/src/goertzel.jl#L29-L54">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="FourierAnalysis.goertzel_fast" href="#FourierAnalysis.goertzel_fast"><code>FourierAnalysis.goertzel_fast</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">function goertzel_fast( x  :: Vector{T},
                        wl :: Int,
                        a  :: Real,
                        c  :: Real,
                        s  :: Real,
                        d  :: Real,
                    startAT:: Int = 1) where T&lt;:Union{Real, Complex}</code></pre><p>Fast version of the <a href="#FourierAnalysis.goertzel"><code>goertzel</code></a> function to be preferred if the function is invoked repeatedly and speed is of concern. The user provides as arguments:</p><ul><li>a time series as input vector <code>x</code>,</li><li><code>wl</code>, the number of samples in <code>x</code> (or the window length),</li><li><code>a</code> = <span>$2/wl$</span>,</li><li><code>c</code> = <span>$cos(p)$</span> where <span>$p$</span>=<code>2*π*round(UInt16, (f*wl)/sr)/wl</code>, <span>$f$</span> is the desired frequency and <span>$sr$</span> the sampling rate,</li><li><code>s</code> = <span>$sin(p)$</span></li><li><code>d</code> = 2*<code>c</code></li><li><code>startAt</code> as in the <a href="#FourierAnalysis.goertzel"><code>goertzel</code></a> function.</li></ul><p><strong>See also</strong>: <a href="#FourierAnalysis.goertzel"><code>goertzel</code></a>, <a href="#FourierAnalysis.goertzel2"><code>goertzel2</code></a>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/Marco-Congedo/FourierAnalysis.jl/blob/45490ae1851aae84a1541ab078e1ac3f39d4a133/src/goertzel.jl#L67-L88">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="FourierAnalysis.goertzel2" href="#FourierAnalysis.goertzel2"><code>FourierAnalysis.goertzel2</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">function goertzel2( x  :: Vector{T},
                    f  :: IntOrReal,
                    sr :: Int,
                    wl :: Int,
                startAT:: Int = 1) where T&lt;:Union{Real, Complex}</code></pre><p>Like the <a href="#FourierAnalysis.goertzel"><code>goertzel</code></a> function, but allows estimating the DFT coefficient in the whole positive real line up to the Nyquist frequency. This is useful when the DFT coefficient is sought for a frequency which is not a discrete Fourier Frequency.</p><p>Using an appropriate taper this function allows almost exact recovery of both amplitude and phase at all frequencies in case of one sinusoid, whereas the <code>goertzel</code> function can do so only at exact Fourier discrete frequencies.</p><p><strong>See also</strong>: <a href="#FourierAnalysis.goertzel_fast"><code>goertzel_fast</code></a>, <a href="#FourierAnalysis.goertzel"><code>goertzel</code></a>.</p><p><strong>Examples</strong>:</p><pre><code class="language-none">using FourierAnalysis
sr, t, f, a = 128, 128, 5, 10
ftrue=f+0.15
v=sinusoidal(a, ftrue, sr, t, 0 )
c=goertzel(v, f, sr, t) # should be 0+aim, but clearly fails
d=goertzel2(v, ftrue, sr, t) # this get closer</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/Marco-Congedo/FourierAnalysis.jl/blob/45490ae1851aae84a1541ab078e1ac3f39d4a133/src/goertzel.jl#L106-L134">source</a></section><footer><hr/><a class="previous" href="../coherence/"><span class="direction">Previous</span><span class="title">Coherence Matrices</span></a><a class="next" href="../timefrequency/"><span class="direction">Next</span><span class="title">TF Representations</span></a></footer></article></body></html>
